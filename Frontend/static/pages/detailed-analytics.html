<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/detailed-analytics.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon"></script>
</head>
<body>
     <!-- Authentication Check -->
    <script>
        // Check if user is logged in
        if (!localStorage.getItem('isLoggedIn') || localStorage.getItem('isLoggedIn') !== 'true') {
            window.location.href = 'sign-up.html';
        }

        // Get current user
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if (!currentUser) {
            window.location.href = 'sign-up.html';
        }
    </script>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-boxes"></i>
                </div>
                <div class="logo-text">InventoryPro</div>
            </div>
            <button class="toggle-btn" id="sidebarToggle">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>

      <div class="sidebar-menu">
            <a href="./dashboard.html" class="menu-item active">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a>

            <a href="./update-category.html" class="menu-item">
                <i class="fas fa-box-open"></i>
                <span>Product Management</span>
            </a>

            <a href="./stockmanagement.html" class="menu-item">
                <i class="fas fa-warehouse"></i>
                <span>Stock Management</span>
            </a>

            <a href="./category-management.html" class="menu-item">
                <i class="fas fa-tags"></i>
                <span>Category Management</span>
            </a>

            <a href="./supplier.html" class="menu-item">
                <i class="fas fa-truck"></i>
                <span>Supplier Management</span>
            </a>

            <a href="./purchase.html" class="menu-item">
                <i class="fas fa-shopping-cart"></i>
                <span>Purchase Management</span>
            </a>

            <a href="./sale.html" class="menu-item">
                <i class="fas fa-chart-line"></i>
                <span>Sales Management</span>
            </a>

            <a href="./detailed-analytics.html" class="menu-item">
                <i class="fas fa-chart-bar"></i>
                <span>Analytics & Reports</span>
            </a>

            <a href="./user-management.html" class="menu-item">
                <i class="fas fa-users"></i>
                <span>User Management</span>
            </a>
            <a href="./back-up.html" class="menu-item">
                <i class="fas fa-database"></i>
                <span>Backup & Export</span>
            </a>
            <a href="./barcode.html " class="menu-item">
                <i class="fas fa-barcode"></i>
                <span>Barcode Scanner</span>
            </a>
            <a href="./notification.html " class="menu-item">
                <i class="fas fa-bell"></i>
                <span>NOtification</span>
            </a>

            <a href="#" class="menu-item" id="logoutSidebar">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 id="pageTitle">Analytics & Reports</h1>
            </div>

            <div class="header-right">
                <div class="user-profile">
                    <div class="user-avatar" id="userAvatar">A</div>
                    <button class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
        </div>

        <!-- Content -->
        <div class="content">
            <!-- Page Header -->
            <div class="page-header">
                <div>
                    <h1 class="page-title">Analytics & Reports</h1>
                    <p class="page-subtitle">Gain insights into your inventory performance, sales trends, and business
                        metrics</p>
                </div>
                <div class="report-actions">
                    <button class="btn btn-primary" id="generateReportBtn">
                        <i class="fas fa-file-pdf"></i> Generate Report
                    </button>
                    <button class="btn btn-success" id="exportDataBtn">
                        <i class="fas fa-download"></i> Export Data
                    </button>
                    <button class="btn btn-warning" id="scheduleReportBtn">
                        <i class="fas fa-calendar-alt"></i> Schedule Report
                    </button>
                </div>
            </div>

            <!-- Date Range Filter -->
            <div class="date-filter">
                <div class="filter-group">
                    <span class="filter-label">Date Range:</span>
                    <input type="date" class="filter-input" id="startDate">
                    <span>to</span>
                    <input type="date" class="filter-input" id="endDate">
                    <select class="filter-select" id="timePeriod">
                        <option value="custom">Custom Range</option>
                        <option value="today">Today</option>
                        <option value="yesterday">Yesterday</option>
                        <option value="week" selected>This Week</option>
                        <option value="month">This Month</option>
                        <option value="quarter">This Quarter</option>
                        <option value="year">This Year</option>
                    </select>
                </div>

                <div class="filter-group">
                    <button class="quick-date-btn active" data-period="week">This Week</button>
                    <button class="quick-date-btn" data-period="month">This Month</button>
                    <button class="quick-date-btn" data-period="quarter">Last Quarter</button>
                    <button class="quick-date-btn" data-period="year">Year to Date</button>
                </div>
            </div>

            <!-- KPI Cards -->
            <div class="kpi-cards">
                <div class="kpi-card">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="kpi-change change-positive">
                            <i class="fas fa-arrow-up"></i> 18.5%
                        </div>
                    </div>
                    <div class="kpi-value" id="totalRevenue">‚Çπ0</div>
                    <div class="kpi-label">Total Revenue</div>
                </div>

                <div class="kpi-card success">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="kpi-change change-positive">
                            <i class="fas fa-arrow-up"></i> 12.3%
                        </div>
                    </div>
                    <div class="kpi-value" id="totalOrders">0</div>
                    <div class="kpi-label">Total Orders</div>
                </div>

                <div class="kpi-card warning">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <div class="kpi-change change-negative">
                            <i class="fas fa-arrow-down"></i> 2.1%
                        </div>
                    </div>
                    <div class="kpi-value" id="profitMargin">0%</div>
                    <div class="kpi-label">Profit Margin</div>
                </div>

                <div class="kpi-card danger">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-boxes"></i>
                        </div>
                        <div class="kpi-change change-positive">
                            <i class="fas fa-arrow-up"></i> 8.7%
                        </div>
                    </div>
                    <div class="kpi-value" id="stockTurnover">0</div>
                    <div class="kpi-label">Stock Turnover Ratio</div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-section">
                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">
                            <i class="fas fa-chart-line"></i> Sales Trend
                        </h3>
                        <select class="filter-select" id="salesChartType" style="width: 150px;">
                            <option value="daily">Daily Sales</option>
                            <option value="weekly">Weekly Sales</option>
                            <option value="monthly">Monthly Sales</option>
                        </select>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="salesTrendChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">
                            <i class="fas fa-chart-pie"></i> Sales by Category
                        </h3>
                        <select class="filter-select" id="categoryChartType" style="width: 150px;">
                            <option value="revenue">By Revenue</option>
                            <option value="quantity">By Quantity</option>
                        </select>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Report Tables -->
            <div class="report-tables">
                <div class="table-container">
                    <div class="table-header">
                        <h3 class="table-title">
                            <i class="fas fa-star"></i> Top Selling Products
                        </h3>
                        <button class="btn btn-outline" onclick="exportTopProducts()">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Category</th>
                                    <th>Units Sold</th>
                                    <th>Revenue</th>
                                    <th>Trend</th>
                                </tr>
                            </thead>
                            <tbody id="topProductsTable">
                                <!-- Top products will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h3 class="table-title">
                            <i class="fas fa-exclamation-triangle"></i> Low Stock Alerts
                        </h3>
                        <button class="btn btn-outline" onclick="exportLowStock()">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Current Stock</th>
                                    <th>Min Stock</th>
                                    <th>Days to Out</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="lowStockTable">
                                <!-- Low stock items will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Export Section -->
            <div class="export-section">
                <h3 class="section-title">
                    <i class="fas fa-file-export"></i> Export Reports
                </h3>
                <p style="color: #7f8c8d; margin-top: 10px;">Generate and download detailed reports in various formats
                </p>

                <div class="export-grid">
                    <div class="export-card">
                        <div class="export-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="export-title">Sales Report</div>
                        <div class="export-desc">Detailed sales analysis with charts and metrics</div>
                        <button class="btn btn-primary" onclick="generateSalesReport()">
                            <i class="fas fa-download"></i> Download PDF
                        </button>
                    </div>

                    <div class="export-card">
                        <div class="export-icon">
                            <i class="fas fa-file-excel"></i>
                        </div>
                        <div class="export-title">Inventory Report</div>
                        <div class="export-desc">Complete inventory listing with stock levels</div>
                        <button class="btn btn-success" onclick="generateInventoryReport()">
                            <i class="fas fa-download"></i> Download Excel
                        </button>
                    </div>

                    <div class="export-card">
                        <div class="export-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div class="export-title">Performance Report</div>
                        <div class="export-desc">Business performance metrics and KPIs</div>
                        <button class="btn btn-warning" onclick="generatePerformanceReport()">
                            <i class="fas fa-download"></i> Download Report
                        </button>
                    </div>
                </div>
            </div>

            <!-- Forecast Section -->
            <div class="forecast-section">
                <h3 class="section-title">
                    <i class="fas fa-chart-line"></i> Sales Forecast & Predictions
                </h3>
                <p style="color: #7f8c8d; margin-top: 10px;">AI-powered predictions for inventory demand and sales
                    trends</p>

                <div class="forecast-grid">
                    <div class="forecast-card">
                        <div class="forecast-header">
                            <div class="forecast-icon">
                                <i class="fas fa-box"></i>
                            </div>
                            <div>
                                <div style="font-size: 20px; font-weight: 700; color: var(--primary-color);">45 items
                                </div>
                                <div style="color: #7f8c8d; font-size: 14px;">Predicted to sell out in 7 days</div>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>High Risk</span>
                                <span style="font-weight: 600; color: var(--accent-color);">12 items</span>
                            </div>
                            <div style="height: 8px; background: #e1e8ed; border-radius: 4px; overflow: hidden;">
                                <div style="height: 100%; background: var(--accent-color); width: 30%;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="forecast-card">
                        <div class="forecast-header">
                            <div class="forecast-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div>
                                <div style="font-size: 20px; font-weight: 700; color: var(--primary-color);">+15.2%
                                </div>
                                <div style="color: #7f8c8d; font-size: 14px;">Expected sales growth next month</div>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Confidence Level</span>
                                <span style="font-weight: 600; color: var(--success-color);">85%</span>
                            </div>
                            <div style="height: 8px; background: #e1e8ed; border-radius: 4px; overflow: hidden;">
                                <div style="height: 100%; background: var(--success-color); width: 85%;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="forecast-card">
                        <div class="forecast-header">
                            <div class="forecast-icon">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <div>
                                <div style="font-size: 20px; font-weight: 700; color: var(--primary-color);">Peak Season
                                </div>
                                <div style="color: #7f8c8d; font-size: 14px;">Next 30 days expected to be busy</div>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <div style="color: #7f8c8d; font-size: 14px; margin-bottom: 10px;">Recommended actions:
                            </div>
                            <ul style="color: #7f8c8d; font-size: 14px; padding-left: 20px;">
                                <li>Increase stock by 25%</li>
                                <li>Run promotional campaigns</li>
                                <li>Prepare for higher order volume</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Insights Section -->
            <div class="insights-section">
                <h3 class="section-title">
                    <i class="fas fa-lightbulb"></i> Business Insights
                </h3>
                <p style="color: #7f8c8d; margin-top: 10px;">Actionable insights derived from your data analysis</p>

                <div class="insights-grid">
                    <div class="insight-card">
                        <div class="insight-title">üìà Revenue Growth Opportunity</div>
                        <div class="insight-desc">Electronics category shows 35% higher profit margin than average.
                            Consider increasing inventory and marketing for this category.</div>
                    </div>

                    <div class="insight-card warning">
                        <div class="insight-title">‚ö†Ô∏è Slow-Moving Inventory</div>
                        <div class="insight-desc">12 items haven't sold in the last 90 days. Consider discounts or
                            promotions to clear this inventory.</div>
                    </div>

                    <div class="insight-card success">
                        <div class="insight-title">‚úÖ Stock Optimization</div>
                        <div class="insight-desc">Your stock turnover ratio improved by 8% this month. Keep monitoring
                            reorder points to maintain efficiency.</div>
                    </div>

                    <div class="insight-card danger">
                        <div class="insight-title">üö® Supplier Performance</div>
                        <div class="insight-desc">Supplier XYZ has 3 delayed shipments this quarter. Consider
                            diversifying suppliers for critical items.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Generate Report Modal -->
    <div class="modal" id="reportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Generate Custom Report</h3>
                <button class="modal-close" id="closeReportModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="reportForm">
                    <div class="form-group">
                        <label for="reportType">Report Type</label>
                        <select id="reportType" class="form-control" required>
                            <option value="">Select Report Type</option>
                            <option value="sales">Sales Report</option>
                            <option value="inventory">Inventory Report</option>
                            <option value="profit">Profit & Loss Report</option>
                            <option value="performance">Performance Analysis</option>
                            <option value="forecast">Sales Forecast</option>
                        </select>
                    </div>

                    <div class="form-row"
                        style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label for="reportStartDate">Start Date</label>
                            <input type="date" id="reportStartDate" class="form-control" required>
                        </div>

                        <div class="form-group">
                            <label for="reportEndDate">End Date</label>
                            <input type="date" id="reportEndDate" class="form-control" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="reportFormat">Format</label>
                        <select id="reportFormat" class="form-control" required>
                            <option value="pdf">PDF Document</option>
                            <option value="excel">Excel Spreadsheet</option>
                            <option value="csv">CSV File</option>
                            <option value="html">HTML Report</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="reportSections">Include Sections</label>
                        <div style="margin-top: 10px;">
                            <div style="display: flex; flex-wrap: wrap; gap: 15px;">
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" checked> Summary
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" checked> Charts & Graphs
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" checked> Detailed Tables
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox"> Recommendations
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox"> Forecast Data
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="reportEmail">Email Report To (Optional)</label>
                        <input type="email" id="reportEmail" class="form-control" placeholder="Enter email address">
                    </div>

                    <div class="form-actions"
                        style="display: flex; justify-content: flex-end; gap: 15px; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
                        <button type="button" class="btn" id="cancelReportBtn"
                            style="background: #e1e8ed; color: #333;">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-file-download"></i> Generate Report
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="../js/detailed-anlytics.js"></script>
</body>
</html>